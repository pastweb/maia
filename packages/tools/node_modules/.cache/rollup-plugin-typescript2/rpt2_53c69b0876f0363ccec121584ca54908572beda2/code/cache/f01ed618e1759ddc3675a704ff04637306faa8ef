{"code":"import { __assign } from \"tslib\";\r\nimport { hashID } from '../hashID';\r\nexport function setElementAttributes(element, attrs) {\r\n    if (!element)\r\n        return;\r\n    Object.entries(attrs).forEach(function (_a) {\r\n        var attr = _a[0], value = _a[1];\r\n        if (attr === 'style') {\r\n            Object.entries(value).forEach(function (_a) {\r\n                var prop = _a[0], value = _a[1];\r\n                element.style[prop] = \"\" + value;\r\n            });\r\n        }\r\n        else {\r\n            element[attr] = \"\" + value;\r\n        }\r\n    });\r\n}\r\nexport function open(portals, _a) {\r\n    var portalId = _a.portalId, _b = _a.tagName, tagName = _b === void 0 ? 'div' : _b, tagAttrs = _a.tagAttrs, _c = _a.app, app = _c === void 0 ? {} : _c;\r\n    var portal = document.getElementById(portalId);\r\n    if (!portal)\r\n        return false;\r\n    var appElement = document.createElement(tagName);\r\n    if (tagAttrs)\r\n        setElementAttributes(appElement, tagAttrs);\r\n    if (!portals[portalId])\r\n        portals[portalId] = {};\r\n    var appId = hashID.generateUnique(Object.keys(portals[portalId]));\r\n    appElement.id = appId;\r\n    portal.appendChild(appElement);\r\n    var _d = app.AppClass, AppClass = _d === void 0 ? (function () {\r\n        function AppClass() {\r\n        }\r\n        AppClass.prototype.mount = function () { };\r\n        return AppClass;\r\n    }()) : _d, _e = app.options, options = _e === void 0 ? {} : _e, _f = app.privateKeys, privateKeys = _f === void 0 ? {} : _f;\r\n    var appInstance = new AppClass(__assign({ portalId: portalId, appId: appId }, options), appElement, privateKeys);\r\n    portals[portalId][appId] = appInstance;\r\n    appInstance.mount();\r\n    return appId;\r\n}\r\nexport function update(portals, _a) {\r\n    var portalId = _a.portalId, appId = _a.appId, tagAttrs = _a.tagAttrs, appData = _a.appData;\r\n    if (!portals[portalId] || (appId !== '*' && !portals[portalId][appId]))\r\n        return false;\r\n    if (tagAttrs)\r\n        setElementAttributes(document.getElementById(appId), tagAttrs);\r\n    if (appData) {\r\n        if (appId === '*') {\r\n            Object.values(portals[portalId]).forEach(function (app) { return app.update(appData); });\r\n        }\r\n        else {\r\n            portals[portalId][appId].update(appData);\r\n        }\r\n    }\r\n    return true;\r\n}\r\nexport function close(portals, _a) {\r\n    var portalId = _a.portalId, appId = _a.appId;\r\n    if (!portals[portalId] || (appId !== '*' && !portals[portalId][appId]))\r\n        return false;\r\n    function closeIt(_a) {\r\n        var portalId = _a.portalId, appId = _a.appId;\r\n        portals[portalId][appId].unmount();\r\n        delete portals[portalId][appId];\r\n        var element = document.getElementById(appId);\r\n        if (element) {\r\n            element.remove();\r\n        }\r\n        return true;\r\n    }\r\n    if (appId === '*') {\r\n        Object.keys(portals[portalId]).forEach(function (appId) { return portals[portalId][appId].emit('mustUnmount'); });\r\n    }\r\n    return closeIt({ portalId: portalId, appId: appId });\r\n}\r\n//# sourceMappingURL=util.js.map","references":["/Users/nico/Projects/maia/@maia/packages/tools/src/hashID/index.ts","/Users/nico/Projects/maia/@maia/packages/tools/src/portal/types.ts","/Users/nico/Projects/maia/@maia/packages/tools/src/App/index.ts"],"map":"{\"version\":3,\"file\":\"util.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/portal/util.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/nico/Projects/maia/@maia/packages/tools/dist/types/portal/util.d.ts","writeByteOrderMark":false,"text":"import { Portals, OpenPortalConfig, UpdatePortalConfig, ClosePortalConfig, HTMLElementAttrs } from './types';\r\nexport declare function setElementAttributes(element: HTMLElement | null, attrs: HTMLElementAttrs): void;\r\nexport declare function open(portals: Portals, { portalId, tagName, tagAttrs, app }: OpenPortalConfig): string | false;\r\nexport declare function update(portals: Portals, { portalId, appId, tagAttrs, appData }: UpdatePortalConfig): boolean;\r\nexport declare function close(portals: Portals, { portalId, appId }: ClosePortalConfig): boolean;\r\n"}}
